---
title: nonce
updated: 2025-04-17 07:58:20Z
created: 2025-04-17 07:38:27Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---

## Fetching a nonce

- Always **check for caching** (some pages may cache tokens – bad practice).
- Some tokens expire quickly — always **fetch a fresh one before submitting**.
- You can often find tokens by searching the page’s HTML for "**token**", "**nonce**", "**csrf**"
* * *

1. From a **Hidden Input Field** in HTML (Most Common) - Used in traditional server-rendered HTML forms.
   
**How**:
- Load the page via GET request.
- Parse the HTML for a hidden input like:
**_token** (Laravel)
**_wpnonce**, **_wpnonce_create-user** (WordPress)
**csrfmiddlewaretoken** (Django)
**csrf_token** (Generic CSRF fields)
  
*eg html*
`<input type="hidden" name="_token" value="abc123xyz">`

**Method**:
*js*
`const match = /name="_token"\s+value="([^"]+)"/.exec(responseText);`

* * *
2. From a **Meta Tag** in the HTML `<head>`
Used in SPAs or apps using JS frameworks (e.g., Vue, React with Laravel or Rails).

*eg html*
`<meta name="csrf-token" content="abc123xyz">`

**How**: 
*js*
`const token = document.querySelector('meta[name="csrf-token"]').getAttribute('content');`

* * *
3. From a **JavaScript Variable** in the Page
   Sometimes the token is embedded in inline JS or JSON.

**Found in:**
*Headless CMSs
Some WordPress plugins
React/Vue apps that inline configs*

*eg html*
`<script>
  var nonce = "abc123xyz";
</script>`

**How**: 
Use a regex like:
*js*
`const match = /var\s+nonce\s*=\s*"([^"]+)"/.exec(responseText);`

* * *
4. From an **HTTP Response Header**
   Some APIs send the token as a response header.
   
**Common in:**
*Rails APIs
Spring Boot
Secure JSON APIs*
   
**Example:**
*makefile*
`X-CSRF-Token: abc123xyz`

**How:**
*js*
`const token = xhr.getResponseHeader('X-CSRF-Token');`

* * *
5. From a **Preflight** or **Dedicated Token Endpoint**
Some frameworks offer a route to fetch a token

**Common in:**
*Next.js API Routes
Django REST Framework (with CSRF middleware)
Headless apps using REST or GraphQL*

**Example:**
*bash*
`GET /api/csrf-token → { "csrf_token": "abc123xyz" }`

**How:**
*js*
```
fetch("/api/csrf-token")
  .then(res => res.json())
  .then(data => console.log(data.csrf_token));
```

* * *
6. From a **JavaScript** Framework's **Internal** Store
   For apps built in frameworks like Angular or React.
   
**Common in:**
*AngularJS
React Redux-based SPAs*

**Example:** Angular might store it in a service:
*js*
`$http.defaults.headers.common['X-CSRFToken'] = token;`

**How:**
Hook into the app context (harder, often needs injected script or dev tools)


