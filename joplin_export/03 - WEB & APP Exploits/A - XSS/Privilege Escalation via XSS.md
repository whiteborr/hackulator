---
title: Privilege Escalation via XSS
updated: 2025-04-18 10:17:58Z
created: 2025-04-16 13:11:03Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---

## Steal session cookies
1. Login with a valid account to the web portal. Open Developer Tools > Storage, check the cookie for options:
**HttpOnly** - If set to **false** , can be retrieved via JavaScript code.
**Secure** - If set to **false** , then the cookie is sent in clear text.

2. If **HttpOnly** is set to **true**, then try next steps like creating an XSS payload to create an admin user.


#### How to craft an XSS payload to create an admin user in WordPress:
https://shift8web.ca/2018/01/craft-xss-payload-create-admin-user-in-wordpress

- [ ] Create a JS function that fetches the wordpress admin ***nonce***
- [ ] Create a payload to "GET" the nonce (as admin), and "PUT" the payload+nonce to the create new user function
- [ ] Minify the code into a single line
- [ ] encode the line into UTF16 (see script 'javascript encode to UTF16')
- [ ] decode the payload using the **fromCharCode** function and into **eval**
`curl -i http://targetURL --user-agent "<script>eval(String.fromCharCode(xxxxxxxxxxxxxxxxxxxxxxxxxxencoded_stringxxxxxxxxxx))</script>"`
* * *

## nonce
https://developer.wordpress.org/apis/security/nonces/

A ***nonce*** is token included in each HTTP request used to prevent Cross-Site-Request-Forgery (**CSRF**) attacks. 
**CSRF** attacks involve socially engineering a user to click a link which runs a malicious script on behalf of the user. 

**Creating a nonce**
You can create a nonce and add it to the query string in a URL, you can add it in a hidden field in a form, or you can use it some other way.

For nonces that are to be used in AJAX requests, it is common to add the nonce to a hidden field, from which JavaScript code can fetch it.
* * *

