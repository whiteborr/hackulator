---
title: DLL hijacking
updated: 2025-05-03 13:47:56Z
created: 2025-05-03 13:26:31Z
latitude: -33.78668940
longitude: 150.95264980
altitude: 0.0000
---

DLL contain code such as icons for executable programs to use.

Try to overwrite a DLL with shell code or script to create admin user
OR
Try hijacking the DLL search order:
https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order

* * *
If a program is missing DLL (eg from a corrupt installation), you can place a DLL using the same name in a directory that is used in the DLL search order (below)
### DLL search order
1. The directoy from which the application loaded.
2. The system directory.
3. The 16-bit system directory.
4. The Windows directory.
5. The current directory.
6. The directories that are listed in the PATH environment variable.`$env:path`

* * *
1. Enumerate Services:
`Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}`
2. Check permissions on service executable file:
`icacls \<path>\<file>`
3. Check for all DLL's loaded (and missing) by the executable using **Process Monitor** or copying the file locally and installing / checking
4. Restart the service
`Restart-Service <service>`